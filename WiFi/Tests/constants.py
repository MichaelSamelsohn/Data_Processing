# Imports #
from WiFi.Settings.wifi_settings import log

log.stream_handler = False
RANDOM_TESTS = 1

# IEEE Std 802.11-2020 OFDM PHY specification, I.1.2 The message for the BCC example, p. 4150.
MESSAGE = """Joy, bright spark of divinity,\nDaughter of Elysium,\nFire-insired we trea"""
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.2 The message for the BCC example, p. 4150, Table I-1—The message for
# the BCC example, octets 25-96 (included).
# Note - These 72 bytes correspond to the 72 bytes of the message (including line breaks).
MESSAGE_IN_BYTES = [
    # Joy, bright spark of divinity,\n
    0x4A, 0x6F, 0x79, 0x2C, 0x20, 0x62, 0x72, 0x69, 0x67, 0x68, 0x74, 0x20, 0x73, 0x70, 0x61, 0x72, 0x6B, 0x20, 0x6F,
    0x66, 0x20, 0x64, 0x69, 0x76, 0x69, 0x6E, 0x69, 0x74, 0x79, 0x2C, 0x0A,

    # Daughter of Elysium,\n
    0x44, 0x61, 0x75, 0x67, 0x68, 0x74, 0x65, 0x72, 0x20, 0x6F, 0x66, 0x20, 0x45, 0x6C, 0x79, 0x73, 0x69, 0x75, 0x6D,
    0x2C, 0x0A,

    # Fire-insired we trea
    0x46, 0x69, 0x72, 0x65, 0x2D, 0x69, 0x6E, 0x73, 0x69, 0x72, 0x65, 0x64, 0x20, 0x77, 0x65, 0x20, 0x74, 0x72, 0x65,
    0x61
]
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.5 Generating the DATA bits for the BCC example, p. 4160-4161,
# Table I-13—The DATA bits before scrambling, bits 208-783 (included).
# Note - These 576 bits correspond to the 72 bytes (each byte is 8 bits) of the message (including line breaks).
MESSAGE_IN_BITS = [
    0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0,
    0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0,
    0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0,
    0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0,
    0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1,
    0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0,
    1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0,
    1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0,
    0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0,
    1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1,
    0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1,
    0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0,
    1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1,
    0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1,
    1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1
]

# IEEE Std 802.11-2020 OFDM PHY specification, I.1.5.2 Scrambling the BCC example, p. 4162, Table I-14.
LFSR_SEQUENCE_SEED_1011101 = [
    0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0,
    0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1,
    0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1,
    0, 0, 0, 1, 0, 1, 1, 1, 0, 1
]

# IEEE Std 802.11-2020 OFDM PHY specification, I.1.4.1 SIGNAL field bit assignment, p. 4156, Table I-7—Bit assignment
# for SIGNAL field.
SIGNAL_FIELD = [1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.4.2 Coding the SIGNAL field bits, p. 4157, Table I-8—SIGNAL field
# bits after encoding.
ENCODED_SIGNAL_FIELD = [
    1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0
]
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.4.3 Interleaving the SIGNAL field bits, p. 4157, Table I-9—SIGNAL
# field bits after interleaving.
INTERLEAVED_SIGNAL_FIELD = [
    1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0,
    0, 1, 0, 0, 1, 0, 1, 0, 0
]
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.4.4 SIGNAL field frequency domain, p. 4158, Table I-10—Frequency
# domain representation of SIGNAL field.
MODULATED_SIGNAL_FIELD = [
    1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, 1, 1,
    -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1
]
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.4.4 SIGNAL field frequency domain, p. 4158-4159, Table I-11—Frequency
# domain representation of SIGNAL field with pilots inserted.
FREQUENCY_DOMAIN_SIGNAL_FIELD = [
    1, -1, -1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1,
    1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, -1, -1
]
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.4.5 SIGNAL field time domain, p. 4159-4160, Table I-12—Time domain
# representation of SIGNAL field.
TIME_DOMAIN_SIGNAL_FIELD = [
    0.031 + 0.000j, 0.033 - 0.044j, -0.002 - 0.038j, -0.081 + 0.084j, 0.007 - 0.100j, -0.001 - 0.113j, -0.021 - 0.005j,
    0.136 - 0.105j, 0.098 - 0.044j, 0.011 - 0.002j, -0.033 + 0.044j, -0.060 + 0.124j, 0.010 + 0.097j, 0.000 - 0.008j,
    0.018 - 0.083j, -0.069 + 0.027j,  # GI.

    -0.219 + 0.000j, -0.069 - 0.027j, 0.018 + 0.083j, 0.000 + 0.008j, 0.010 - 0.097j, -0.060 - 0.124j, -0.033 - 0.044j,
    0.011 + 0.002j, 0.098 + 0.044j, 0.136 + 0.105j, -0.021 + 0.005j, -0.001 + 0.113j, 0.007 + 0.100j, -0.081 - 0.084j,
    -0.002 + 0.038j, 0.033 + 0.044j, 0.062 + 0.000j, 0.057 + 0.052j, 0.016 + 0.174j, 0.035 + 0.116j, -0.051 - 0.202j,
    0.011 + 0.036j, 0.089 + 0.209j, -0.049 - 0.008j, -0.035 + 0.044j, 0.017 - 0.059j, 0.053 - 0.017j, 0.099 + 0.100j,
    0.034 - 0.148j, -0.003 - 0.094j, -0.120 + 0.042j, -0.136 - 0.070j, -0.031 + 0.000j, -0.136 + 0.070j,
    -0.120 - 0.042j, -0.003 + 0.094j, 0.034 + 0.148j, 0.099 - 0.100j, 0.053 + 0.017j, 0.017 + 0.059j, -0.035 - 0.044j,
    -0.049 + 0.008j, 0.089 - 0.209j, 0.011 - 0.036j, -0.051 + 0.202j, 0.035 - 0.116j, 0.016 - 0.174j, 0.057 - 0.052j,
    0.062 + 0.000j, 0.033 - 0.044j, -0.002 - 0.038j, -0.081 + 0.084j, 0.007 - 0.100j, -0.001 - 0.113j, -0.021 - 0.005j,
    0.136 - 0.105j, 0.098 - 0.044j, 0.011 - 0.002j, -0.033 + 0.044j, -0.060 + 0.124j, 0.010 + 0.097j, 0.000 - 0.008j,
    0.018 - 0.083j, -0.069 + 0.027j,  # SIGNAL

    -0.1095 + 0.000j  # Serves as an overlap with the following OFDM symbol.
]
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.3.1 Generation of the short sequences, p. 4152-4153, Table I-4—Time
# domain representation of the short sequence.
TIME_DOMAIN_STF = [
    0.023 + 0.023j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t1.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t2.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t3.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t4.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t5.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t6.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t7.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t8.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t9.

    0.046 + 0.046j, -0.132 + 0.002j, -0.013 - 0.079j, 0.143 - 0.013j, 0.092, 0.143 - 0.013j, -0.013 - 0.079j,
    -0.132 + 0.002j, 0.046 + 0.046j, 0.002 - 0.132j, -0.079 - 0.013j, -0.013 + 0.143j, 0.092j, -0.013 + 0.143j,
    -0.079 - 0.013j, 0.002 - 0.132j,  # t10.

    0.023 + 0.023j  # Serves as an overlap with the following OFDM symbol.
]
# IEEE Std 802.11-2020 OFDM PHY specification, I.1.3.2 Generation of the long sequences, p. 4154, Table I-6—Time domain
# representation of the long sequence.
TIME_DOMAIN_LTF = [
    -0.078 + 0.000j, 0.012 - 0.098j, 0.092 - 0.106j, -0.092 - 0.115j, -0.003 - 0.054j, 0.075 + 0.074j, -0.127 + 0.021j,
    -0.122 + 0.017j, -0.035 + 0.151j, -0.056 + 0.022j, -0.060 - 0.081j, 0.070 - 0.014j, 0.082 - 0.092j, -0.131 - 0.065j,
    -0.057 - 0.039j, 0.037 - 0.098j, 0.062 + 0.062j, 0.119 + 0.004j, -0.022 - 0.161j, 0.059 + 0.015j, 0.024 + 0.059j,
    -0.137 + 0.047j, 0.001 + 0.115j, 0.053 - 0.004j, 0.098 + 0.026j, -0.038 + 0.106j, -0.115 + 0.055j, 0.060 + 0.088j,
    0.021 - 0.028j, 0.097 - 0.083j, 0.040 + 0.111j, -0.005 + 0.120j,  # GI2.

    0.156 + 0.000j, -0.005 - 0.120j, 0.040 - 0.111j, 0.097 + 0.083j, 0.021 + 0.028j, 0.060 - 0.088j, -0.115 - 0.055j,
    -0.038 - 0.106j, 0.098 - 0.026j, 0.053 + 0.004j, 0.001 - 0.115j, -0.137 - 0.047j, 0.024 - 0.059j, 0.059 - 0.015j,
    -0.022 + 0.161j, 0.119 - 0.004j, 0.062 - 0.062j, 0.037 + 0.098j, -0.057 + 0.039j, -0.131 + 0.065j, 0.082 + 0.092j,
    0.070 + 0.014j, -0.060 + 0.081j, -0.056 - 0.022j, -0.035 - 0.151j, -0.122 - 0.017j, -0.127 - 0.021j, 0.075 - 0.074j,
    -0.003 + 0.054j, -0.092 + 0.115j, 0.092 + 0.106j, 0.012 + 0.098j, -0.156 + 0.000j, 0.012 - 0.098j, 0.092 - 0.106j,
    -0.092 - 0.115j, -0.003 - 0.054j, 0.075 + 0.074j, -0.127 + 0.021j, -0.122 + 0.017j, -0.035 + 0.151j,
    -0.056 + 0.022j, -0.060 - 0.081j, 0.070 - 0.014j, 0.082 - 0.092j, -0.131 - 0.065j, -0.057 - 0.039j, 0.037 - 0.098j,
    0.062 + 0.062j, 0.119 + 0.004j, -0.022 - 0.161j, 0.059 + 0.015j, 0.024 + 0.059j, -0.137 + 0.047j, 0.001 + 0.115j,
    0.053 - 0.004j, 0.098 + 0.026j, -0.038 + 0.106j, -0.115 + 0.055j, 0.060 + 0.088j, 0.021 - 0.028j, 0.097 - 0.083j,
    0.040 + 0.111j, -0.005 + 0.120j,  # T1.

    0.156 + 0.000j, -0.005 - 0.120j, 0.040 - 0.111j, 0.097 + 0.083j, 0.021 + 0.028j, 0.060 - 0.088j, -0.115 - 0.055j,
    -0.038 - 0.106j, 0.098 - 0.026j, 0.053 + 0.004j, 0.001 - 0.115j, -0.137 - 0.047j, 0.024 - 0.059j, 0.059 - 0.015j,
    -0.022 + 0.161j, 0.119 - 0.004j, 0.062 - 0.062j, 0.037 + 0.098j, -0.057 + 0.039j, -0.131 + 0.065j, 0.082 + 0.092j,
    0.070 + 0.014j, -0.060 + 0.081j, -0.056 - 0.022j, -0.035 - 0.151j, -0.122 - 0.017j, -0.127 - 0.021j, 0.075 - 0.074j,
    -0.003 + 0.054j, -0.092 + 0.115j, 0.092 + 0.106j, 0.012 + 0.098j, -0.156 + 0.000j, 0.012 - 0.098j, 0.092 - 0.106j,
    -0.092 - 0.115j, -0.003 - 0.054j, 0.075 + 0.074j, -0.127 + 0.021j, -0.122 + 0.017j, -0.035 + 0.151j,
    -0.056 + 0.022j, -0.060 - 0.081j, 0.070 - 0.014j, 0.082 - 0.092j, -0.131 - 0.065j, -0.057 - 0.039j, 0.037 - 0.098j,
    0.062 + 0.062j, 0.119 + 0.004j, -0.022 - 0.161j, 0.059 + 0.015j, 0.024 + 0.059j, -0.137 + 0.047j, 0.001 + 0.115j,
    0.053 - 0.004j, 0.098 + 0.026j, -0.038 + 0.106j, -0.115 + 0.055j, 0.060 + 0.088j, 0.021 - 0.028j, 0.097 - 0.083j,
    0.040 + 0.111j, -0.005 + 0.120j,  # T2.

    0.078 + 0.000j  # Serves as an overlap with the following OFDM symbol.
]